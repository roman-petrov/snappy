# üöÄ –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –¥–µ–ø–ª–æ—é Snappy Bot

## –°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ –ø–æ–¥—Ö–æ–¥—ã –∫ –¥–µ–ø–ª–æ—é

### 1. **GitHub Actions (–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)** ‚≠ê

–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –¥–µ–ø–ª–æ–π –ø—Ä–∏ push –≤ `main` –∏–ª–∏ –ø–æ –∫–Ω–æ–ø–∫–µ –≤ GitHub UI.

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**

- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è "–∏–∑ –∫–æ—Ä–æ–±–∫–∏"
- ‚úÖ –ò—Å—Ç–æ—Ä–∏—è –¥–µ–ø–ª–æ–µ–≤ –≤ GitHub
- ‚úÖ –ë–µ–∑–æ–ø–∞—Å–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å–µ–∫—Ä–µ—Ç–æ–≤
- ‚úÖ –ó–∞–ø—É—Å–∫ –æ–¥–Ω–æ–π –∫–Ω–æ–ø–∫–æ–π —á–µ—Ä–µ–∑ GitHub UI
- ‚úÖ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å CI/CD

### 2. **Docker + Docker Compose**

–ö–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –¥–ª—è –∏–∑–æ–ª—è—Ü–∏–∏ –∏ –ø—Ä–æ—Å—Ç–æ—Ç—ã –¥–µ–ø–ª–æ—è.

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**

- ‚úÖ –ò–∑–æ–ª—è—Ü–∏—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
- ‚úÖ –õ–µ–≥–∫–æ–µ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ
- ‚úÖ –ü—Ä–æ—Å—Ç–æ–µ –æ—Ç–∫–∞—Ç—ã–≤–∞–Ω–∏–µ –≤–µ—Ä—Å–∏–π

### 3. **–¢—Ä–∞–¥–∏—Ü–∏–æ–Ω–Ω—ã–π SSH + rsync**

–†—É—á–Ω–æ–π –¥–µ–ø–ª–æ–π —á–µ—Ä–µ–∑ —Å–∫—Ä–∏–ø—Ç (—É–∂–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω –≤ `!deploy.bat`).

## –ù–∞—Å—Ç—Ä–æ–π–∫–∞ GitHub Actions –¥–µ–ø–ª–æ—è

### –®–∞–≥ 1: –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ SSH –∫–ª—é—á–∞

1. –°–≥–µ–Ω–µ—Ä–∏—Ä—É–π—Ç–µ SSH –∫–ª—é—á (–µ—Å–ª–∏ –µ—â–µ –Ω–µ—Ç):

   ```bash
   ssh-keygen -t ed25519 -C "github-actions-deploy"
   ```

2. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –ø—É–±–ª–∏—á–Ω—ã–π –∫–ª—é—á –Ω–∞ —Å–µ—Ä–≤–µ—Ä:

   ```bash
   ssh-copy-id -p <PORT> user@your-server.com
   ```

3. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –ø—Ä–∏–≤–∞—Ç–Ω—ã–π –∫–ª—é—á –ø–æ–ª–Ω–æ—Å—Ç—å—é (–≤–∫–ª—é—á–∞—è `-----BEGIN` –∏ `-----END`)

### –®–∞–≥ 2: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ GitHub Environment –∏ Secrets

1. –°–æ–∑–¥–∞–π—Ç–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ: –ø–µ—Ä–µ–π–¥–∏—Ç–µ –≤ `Settings` ‚Üí `Environments` ‚Üí `New environment` ‚Üí –≤–≤–µ–¥–∏—Ç–µ `production`.

2. –î–æ–±–∞–≤—å—Ç–µ —Å–µ–∫—Ä–µ—Ç—ã –≤ –æ–∫—Ä—É–∂–µ–Ω–∏–µ `production`: –æ—Ç–∫—Ä–æ–π—Ç–µ —Å–æ–∑–¥–∞–Ω–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ ‚Üí `Environment secrets` ‚Üí –¥–æ–±–∞–≤—å—Ç–µ:

| Secret            | –û–ø–∏—Å–∞–Ω–∏–µ                       | –ü—Ä–∏–º–µ—Ä                                |
| ----------------- | ------------------------------ | ------------------------------------- |
| `SSH_HOST`        | IP –∏–ª–∏ –¥–æ–º–µ–Ω —Å–µ—Ä–≤–µ—Ä–∞           | `192.168.1.100` –∏–ª–∏ `bot.example.com` |
| `SSH_USER`        | –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –¥–ª—è SSH           | `deploy` –∏–ª–∏ `ubuntu`                 |
| `SSH_PORT`        | –ü–æ—Ä—Ç SSH (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)         | `22` (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)                   |
| `SSH_PRIVATE_KEY` | –ü—Ä–∏–≤–∞—Ç–Ω—ã–π SSH –∫–ª—é—á             | –í–µ—Å—å –∫–ª—é—á —Å BEGIN/END                 |
| `REMOTE_PATH`     | –ü—É—Ç—å –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ                | `/home/deploy/snappy`                 |
| `USE_PM2`         | –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å PM2 (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) | `true` –∏–ª–∏ `false`                    |

> **–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:** –°–µ–∫—Ä–µ—Ç—ã —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ –æ–∫—Ä—É–∂–µ–Ω–∏–∏ `production`, —á—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø—Ä–∞–≤–∏–ª–∞ –∑–∞—â–∏—Ç—ã (–Ω–∞–ø—Ä–∏–º–µ—Ä,
> –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –ø–µ—Ä–µ–¥ –¥–µ–ø–ª–æ–µ–º).

### –®–∞–≥ 3: –ó–∞–ø—É—Å–∫ –¥–µ–ø–ª–æ—è

**–†—É—á–Ω–æ–π –¥–µ–ø–ª–æ–π (–æ–¥–Ω–∞ –∫–Ω–æ–ø–∫–∞):**

1. –û—Ç–∫—Ä–æ–π—Ç–µ –≤–∫–ª–∞–¥–∫—É `Actions` –≤ GitHub
2. –í—ã–±–µ—Ä–∏—Ç–µ workflow `Deploy to Server`
3. –ù–∞–∂–º–∏—Ç–µ `Run workflow`
4. –í—ã–±–µ—Ä–∏—Ç–µ –≤–µ—Ç–∫—É (–æ–±—ã—á–Ω–æ `main`) –∏ –Ω–∞–∂–º–∏—Ç–µ `Run workflow`

> **–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:** –î–µ–ø–ª–æ–π –Ω–∞—Å—Ç—Ä–æ–µ–Ω —Ç–æ–ª—å–∫–æ –Ω–∞ —Ä—É—á–Ω–æ–π –∑–∞–ø—É—Å–∫ –¥–ª—è –±–æ–ª—å—à–µ–≥–æ –∫–æ–Ω—Ç—Ä–æ–ª—è –Ω–∞–¥ –ø—Ä–æ—Ü–µ—Å—Å–æ–º.

## –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞

### –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Bun
curl -fsSL https://bun.sh/install | bash

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ PM2 (–µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ)
npm install -g pm2

# –ò–ª–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ systemd (–µ—Å–ª–∏ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ PM2)
sudo nano /etc/systemd/system/snappy-bot.service
```

### –ü—Ä–∏–º–µ—Ä systemd —Å–µ—Ä–≤–∏—Å–∞

```ini
[Unit]
Description=Snappy Telegram Bot
After=network.target

[Service]
Type=simple
User=deploy
WorkingDirectory=/home/deploy/snappy
ExecStart=/home/deploy/.bun/bin/bun run start
Restart=always
RestartSec=10
Environment=NODE_ENV=production

[Install]
WantedBy=multi-user.target
```

–ê–∫—Ç–∏–≤–∞—Ü–∏—è:

```bash
sudo systemctl daemon-reload
sudo systemctl enable snappy-bot
sudo systemctl start snappy-bot
```

## –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è

### Docker Compose (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

–°–æ–∑–¥–∞–π—Ç–µ `docker-compose.yml` –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ:

```yaml
version: "3.8"

services:
  snappy-bot:
    image: your-dockerhub/snappy-bot:latest
    restart: always
    environment:
      - BOT_TOKEN=${BOT_TOKEN}
      - NODE_ENV=production
    volumes:
      - ./data:/app/data
```

### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≥–æ—Ç–æ–≤—ã—Ö –ø–ª–∞—Ç—Ñ–æ—Ä–º

- **Railway** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –¥–µ–ø–ª–æ–π –∏–∑ GitHub
- **Render** - –ø—Ä–æ—Å—Ç–æ–π –¥–µ–ø–ª–æ–π —Å –∞–≤—Ç–æ-–¥–µ–ø–ª–æ–µ–º –∏–∑ Git
- **Fly.io** - –≥–ª–æ–±–∞–ª—å–Ω–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ
- **DigitalOcean App Platform** - —É–ø—Ä–∞–≤–ª—è–µ–º—ã–π –¥–µ–ø–ª–æ–π

## –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –ª–æ–≥–∏

### PM2

```bash
pm2 logs snappy-bot
pm2 monit
pm2 status
```

### Systemd

```bash
sudo journalctl -u snappy-bot -f
sudo systemctl status snappy-bot
```

## –û—Ç–∫–∞—Ç –∏–∑–º–µ–Ω–µ–Ω–∏–π

–ï—Å–ª–∏ —á—Ç–æ-—Ç–æ –ø–æ—à–ª–æ –Ω–µ —Ç–∞–∫:

```bash
# –ß–µ—Ä–µ–∑ Git –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
ssh user@server
cd /path/to/snappy
git checkout <previous-commit>
bun install --production
pm2 restart snappy-bot  # –∏–ª–∏ systemctl restart snappy-bot
```

## –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

- ‚úÖ –ù–∏–∫–æ–≥–¥–∞ –Ω–µ –∫–æ–º–º–∏—Ç—å—Ç–µ —Å–µ–∫—Ä–µ—Ç—ã –≤ Git
- ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ GitHub Secrets –¥–ª—è –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ –û–≥—Ä–∞–Ω–∏—á—å—Ç–µ –ø—Ä–∞–≤–∞ SSH –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ SSH –∫–ª—é—á–∏ –≤–º–µ—Å—Ç–æ –ø–∞—Ä–æ–ª–µ–π
- ‚úÖ –†–µ–≥—É–ª—è—Ä–Ω–æ –æ–±–Ω–æ–≤–ª—è–π—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
